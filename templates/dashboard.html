<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard | SAMPROX ERP</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}" />
</head>
<body>
    <div class="page">
        <header class="topbar">
            <div class="brand">
                <div class="brand__logo">S</div>
                <div class="brand__details">
                    <p class="brand__name">SAMPROX ERP</p>
                    <p class="brand__section">6M Operations Dashboard</p>
                </div>
            </div>
            <div class="topbar__actions">
                <div class="user-summary">
                    <span class="user-summary__name" id="user-name"></span>
                    <span class="user-summary__role" id="user-role"></span>
                </div>
                <button type="button" class="button button--secondary" id="logout">Sign out</button>
            </div>
        </header>
        <nav class="subnav" aria-label="6M navigation">
            <a class="subnav__link" href="{{ url_for('ui.man_page') }}">Man</a>
            <a class="subnav__link" href="{{ url_for('ui.machines_page') }}">Machine</a>
            <a class="subnav__link" href="{{ url_for('ui.material_page') }}">Material</a>
            <a class="subnav__link" href="{{ url_for('ui.market_page') }}">Market</a>
            <a class="subnav__link" href="{{ url_for('ui.manufacturing_page') }}">Manufacturing</a>
            <a class="subnav__link" href="{{ url_for('ui.money_page') }}">Money</a>
        </nav>
        <section class="section">
            <header class="section__header">
                <h1>Manage the entire operation with the 6M model</h1>
            </header>
            <p class="section__description">
                Track each resource pillar with focused workspaces. Use the cards below to open the
                dedicated page for each "M" and keep teams aligned on their responsibilities.
            </p>
            <div class="dashboard">
                <article class="card">
                    <h2 class="card__title">Man</h2>
                    <p class="card__description">
                        Coordinate workforce planning, team assignments, and skill development. Capture
                        training needs and ensure the right people are assigned to the right jobs.
                    </p>
                    <div class="card__actions">
                        <a class="card__link" href="{{ url_for('ui.man_page') }}">Open Man workspace</a>
                    </div>
                </article>
                <article class="card">
                    <h2 class="card__title">Machine</h2>
                    <p class="card__description">
                        Monitor machine health, schedule maintenance, and review asset utilization. Log
                        maintenance jobs and keep equipment ready for production.
                    </p>
                    <div class="card__actions">
                        <a class="card__link" href="{{ url_for('ui.machines_page') }}">Open Machine workspace</a>
                    </div>
                </article>
                <article class="card">
                    <h2 class="card__title">Material</h2>
                    <p class="card__description">
                        Keep an eye on inventory balances, supplier performance, and material movement.
                        Track what is on hand and what needs to be reordered to support production.
                    </p>
                    <div class="card__actions">
                        <a class="card__link" href="{{ url_for('ui.material_page') }}">Open Material workspace</a>
                    </div>
                </article>
                <article class="card">
                    <h2 class="card__title">Market</h2>
                    <p class="card__description">
                        Review customer demand, order pipelines, and market feedback. Align production
                        priorities with sales opportunities and customer commitments.
                    </p>
                    <div class="card__actions">
                        <a class="card__link" href="{{ url_for('ui.market_page') }}">Open Market workspace</a>
                    </div>
                </article>
                <article class="card">
                    <h2 class="card__title">Manufacturing</h2>
                    <p class="card__description">
                        Coordinate production schedules, capacity plans, and in-process quality checks
                        to keep every order on track from release to shipment.
                    </p>
                    <div class="card__actions">
                        <a class="card__link" href="{{ url_for('ui.manufacturing_page') }}">Open Manufacturing workspace</a>
                    </div>
                </article>
                <article class="card">
                    <h2 class="card__title">Money</h2>
                    <p class="card__description">
                        Stay on top of budgets, job costs, and cash flow. Build visibility into
                        financial performance to inform operational decisions.
                    </p>
                    <div class="card__actions">
                        <a class="card__link" href="{{ url_for('ui.money_page') }}">Open Money workspace</a>
                    </div>
                </article>
            </div>
        </section>
    </div>
    <script>
        const token = localStorage.getItem("samprox_token");
        const userRaw = localStorage.getItem("samprox_user");
        let user;

        try {
            user = userRaw ? JSON.parse(userRaw) : null;
        } catch (_) {
            user = null;
        }

        if (!token || !user) {
            window.location.href = "/";
        }

        const roleLabels = {
            admin: "Admin",
            production_manager: "Production Manager",
            maintenance_manager: "Maintenance Manager",
            technician: "Technician",
        };

        const userNameEl = document.getElementById("user-name");
        const userRoleEl = document.getElementById("user-role");
        const logoutButton = document.getElementById("logout");

        userNameEl.textContent = user?.name || "Unknown";
        userRoleEl.textContent = roleLabels[user?.role] || "";

        logoutButton.addEventListener("click", () => {
            localStorage.removeItem("samprox_token");
            localStorage.removeItem("samprox_user");
            window.location.href = "/";
        });
    </script>
</body>
</html>
