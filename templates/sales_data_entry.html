{% extends "sales_base.html" %}
{% set active_tab = "data-entry" %}
{% block page_title %}Sales Data Entry | SAMPROX ERP{% endblock %}
{% block content %}
<section class="section">
    <header class="section__header">
        <div>
            <p class="eyebrow">Data capture</p>
            <h1>Sales Data Entry</h1>
            <p class="section__description">
                Use this workspace to enter or review sales records. Inputs remain intentionally minimal so granular rules can be added later.
            </p>
        </div>
    </header>
    <div class="section__grid section__grid--two-col hidden" id="sales-action-tiles" aria-live="polite">
        <a
            class="tile tile--link"
            href="/sales/invoice"
            role="link"
            aria-label="Create Invoice"
            onkeydown="if(event.key === ' ' || event.key === 'Spacebar'){event.preventDefault(); event.currentTarget.click();}"
        >
            <div class="system-status__item-icon" aria-hidden="true">üßæ</div>
            <h2 class="tile__title">Create Invoice</h2>
            <p class="tile__description">Create and manage sales invoices.</p>
        </a>
        <a
            class="tile tile--link"
            href="/sales/receipts"
            role="link"
            aria-label="Record Receipts"
            onkeydown="if(event.key === ' ' || event.key === 'Spacebar'){event.preventDefault(); event.currentTarget.click();}"
        >
            <div class="system-status__item-icon" aria-hidden="true">üí≥</div>
            <h2 class="tile__title">Record Receipts</h2>
            <p class="tile__description">Record customer payments and receipts.</p>
        </a>
        <a
            class="tile tile--link"
            href="/sales/production"
            role="link"
            aria-label="Record Production"
            onkeydown="if(event.key === ' ' || event.key === 'Spacebar'){event.preventDefault(); event.currentTarget.click();}"
        >
            <div class="system-status__item-icon" aria-hidden="true">üè≠</div>
            <h2 class="tile__title">Record Production</h2>
            <p class="tile__description">Log production output related to sales orders.</p>
        </a>
        <a
            class="tile tile--link"
            href="/sales/data-entry/returns"
            role="link"
            aria-label="Record Sales Return"
            onkeydown="if(event.key === ' ' || event.key === 'Spacebar'){event.preventDefault(); event.currentTarget.click();}"
        >
            <div class="system-status__item-icon" aria-hidden="true">üîÅ</div>
            <p class="tile__subtitle">Water Pumps</p>
            <h2 class="tile__title">Record Sales Return</h2>
            <p class="tile__description">
                Capture returned water pumps against invoices and update stock automatically.
            </p>
        </a>
        <a
            class="tile tile--link"
            href="/sales/data-entry/travel-claims"
            role="link"
            aria-label="Travel Claims"
            onkeydown="if(event.key === ' ' || event.key === 'Spacebar'){event.preventDefault(); event.currentTarget.click();}"
        >
            <div class="system-status__item-icon" aria-hidden="true">üß≥</div>
            <p class="tile__subtitle">Petty Cash ‚Äì Weekly Travel Claims</p>
            <h2 class="tile__title">Travel Claims</h2>
            <p class="tile__description">Capture weekly travel expenses and submit for approval.</p>
        </a>
    </div>
    <div class="card" id="sales-entry-form">
        <div class="form-grid">
            <label class="form-field">
                <span>Entry type</span>
                <select id="sales-entry-type">
                    <option value="">Select</option>
                    <option value="actual">Actual</option>
                    <option value="forecast">Forecast</option>
                </select>
            </label>
            <label class="form-field">
                <span>Customer</span>
                <input type="text" id="sales-entry-customer" placeholder="Search or select customer" />
            </label>
            <label class="form-field">
                <span>Date</span>
                <input type="date" id="sales-entry-date" />
            </label>
            <label class="form-field">
                <span>Quantity</span>
                <input type="number" step="any" id="sales-entry-quantity" placeholder="Tons or units" />
            </label>
            <label class="form-field">
                <span>Unit price</span>
                <input type="number" step="any" id="sales-entry-unit-price" placeholder="LKR" />
            </label>
        </div>
        <p class="form-feedback" id="sales-entry-feedback">Future validations and submission hooks will plug in here.</p>
        <div class="card__actions">
            <button type="button" class="button button--primary" id="sales-entry-save">Save entry</button>
            <button type="button" class="button button--ghost" id="sales-entry-reset">Reset</button>
        </div>
    </div>
</section>
<script>
    (function () {
        const userRole = (JSON.parse(localStorage.getItem("samprox_user") || "null")?.role || "").toLowerCase();
        const isSalesManager = userRole === "sales_manager";
        const isSalesExecutive = userRole === "sales_executive";

        const actionTiles = document.getElementById("sales-action-tiles");
        const entryForm = document.getElementById("sales-entry-form");

        if (isSalesManager || isSalesExecutive) {
            actionTiles?.classList.remove("hidden");
            entryForm?.classList.add("hidden");
        } else {
            actionTiles?.classList.add("hidden");
            entryForm?.classList.remove("hidden");
        }
    })();
</script>
{% endblock %}
