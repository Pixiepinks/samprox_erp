{% extends "sales_base.html" %}
{% set active_tab = "dashboard" %}
{% block page_title %}Sales Dashboard | SAMPROX ERP{% endblock %}
{% block content %}
<section class="section">
    <header class="section__header">
        <div>
            <p class="eyebrow">Sales overview</p>
            <h1>Sales Dashboard</h1>
            <p class="section__description">
                Track the latest sales pulse. This shell is ready for charts and KPIs without locking in any future business rules.
            </p>
        </div>
    </header>
    <div class="section__grid">
        <article class="tile">
            <h2 class="tile__title">Pipeline summary</h2>
            <p class="tile__description">Placeholder for upcoming pipeline KPIs and quick filters.</p>
        </article>
        <article class="tile">
            <h2 class="tile__title">Dispatch status</h2>
            <p class="tile__description">Future widget for daily/weekly dispatch visibility.</p>
        </article>
        <article class="tile">
            <h2 class="tile__title">Priority customers</h2>
            <p class="tile__description">Surface high-touch accounts and their recent interactions.</p>
        </article>
    </div>
</section>
{% if show_exsol_stacked_widget %}
<section class="section">
    <article class="card exsol-stacked-card" data-exsol-stacked-widget>
        <div class="exsol-stacked-card__header">
            <div class="exsol-stacked-card__intro">
                <p class="eyebrow">Exsol sales</p>
                <h2 class="card__title">Exsol MTD Sales (Stacked by Item Code)</h2>
                <p class="card__description">Track month-to-date Exsol sales by salesperson and item.</p>
            </div>
            <div class="exsol-stacked-card__top">
                <div class="exsol-stacked-card__summary">
                    <div class="exsol-stacked-kpi">
                        <p class="exsol-stacked-kpi__label">Sales Amount (Rs.)</p>
                        <p class="exsol-stacked-kpi__subtitle">Month to Date</p>
                        <p class="exsol-stacked-kpi__value" id="exsol-mtd-sales">Rs. 0</p>
                        <div class="exsol-stacked-kpi__details">
                            <p class="exsol-stacked-kpi__detail" id="exsol-mtd-sales-water-pumps">
                                Water Pumps: Rs. 0
                            </p>
                            <p class="exsol-stacked-kpi__detail" id="exsol-mtd-sales-pressure-switch">
                                Pressure Switch: Rs. 0
                            </p>
                        </div>
                    </div>
                    <div class="exsol-stacked-kpi">
                        <p class="exsol-stacked-kpi__label">Water Pump Qty</p>
                        <p class="exsol-stacked-kpi__subtitle">Month to Date</p>
                        <p class="exsol-stacked-kpi__value" id="exsol-mtd-qty">0 Units</p>
                        <div class="exsol-stacked-kpi__details">
                            <p class="exsol-stacked-kpi__detail" id="exsol-mtd-qty-pressure-switch">
                                Pressure Switch: 0 Units
                            </p>
                        </div>
                    </div>
                </div>
                <div class="exsol-stacked-card__controls">
                    <label class="exsol-stacked-card__control">
                        <span>Start date</span>
                        <input type="date" id="exsol-stacked-start" />
                    </label>
                    <label class="exsol-stacked-card__control">
                        <span>End date</span>
                        <input type="date" id="exsol-stacked-end" />
                    </label>
                    <label class="exsol-stacked-card__control">
                        <span>Items</span>
                        <select id="exsol-stacked-items" multiple></select>
                    </label>
                    <label class="exsol-stacked-card__control">
                        <span>Metric</span>
                        <select id="exsol-stacked-metric">
                            <option value="amount" selected>Sales Amount (LKR)</option>
                            <option value="qty">Quantity (Units)</option>
                        </select>
                    </label>
                    <label class="exsol-stacked-card__control exsol-stacked-card__checkbox">
                        <input type="checkbox" id="exsol-stacked-compare" />
                        <span>Compare with Previous Month</span>
                    </label>
                    <div class="exsol-stacked-card__action">
                        <button type="button" class="button" id="exsol-stacked-apply">Apply</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="exsol-stacked-card__body">
            <div class="exsol-stacked-card__status" data-exsol-stacked-status hidden>Loadingâ€¦</div>
            <div class="exsol-stacked-card__canvas">
                <canvas id="exsol-stacked-chart" aria-label="Exsol stacked bar chart" role="img"></canvas>
            </div>
        </div>
    </article>
</section>
{% endif %}
{% if show_exsol_stacked_widget %}
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" defer></script>
<script src="{{ url_for('static', filename='js/exsol_mtd_stacked_chart.js') }}" defer></script>
{% endif %}
{% endblock %}
